{"version":3,"sources":["../../node_modules/lodash.debounce/index.js","utils/is-mobile.js","graphic.js","footer.js","main.js"],"names":["isMobile","android","navigator","userAgent","match","blackberry","ios","opera","windows","any","stepperTriggered","resize","setupStepper","steps","step0","step1","step2","step3","step4","step5","step6","tapLeft","d3","select","on","currentStep","switchStep","console","log","event","stopPropagation","tapRight","tapDown","document","querySelector","scrollIntoView","behavior","entirePage","d","classed","style","transition","pause","duration","delay","currentTime","play","selectAll","filter","step_used","highlightAss","window","setTimeout","scrollTween","offset","i","interpolateNumber","pageYOffset","documentElement","scrollTop","t","scrollTo","tween","innerHeight","attr","tapBack","step7","scriptLines","getElementsByClassName","x","innerHTML","replace","assOnlyScript","csv","then","setupStepperScript","datapoints","scriptContainer","append","data","enter","text","catch","error","setupAssLine","container","length","citationData","margin","top","right","bottom","left","height","width","innerWidth","sliderContainer","svg","lineFunction","line","y","lineData","citationCounter","slice","citationDates","map","date","firstDate","lastDate","xPositionScale","scaleLinear","domain","range","indexCounter","newDate","timeLine","yearLabelStart","yearLabelEnd","citationCircles","citationContainer","value","property","dates","selected","reduce","prev","curr","Math","abs","setupScroller","json","citations","buildCitationTimeline","usageData","icebergnumber","overlaynumber","number_of_citations","Array","buildIcebergTextChart","filename","icebergChart","citationsLengths","colorScale","scaleOrdinal","spans","sort","word","currentState","overlay","leftShape","rightShape","buildIcebergTextList","overlayHeight","usages","ismo_example","html","part_of_speech","definition","each","init","fallbackData","image","url","hed","storyData","loadJS","src","cb","ref","getElementsByTagName","script","createElement","async","parentNode","insertBefore","onload","loadStories","request","XMLHttpRequest","v","Date","now","open","status","JSON","parse","responseText","onerror","send","createLink","recircHTML","location","href","includes","join","setupSocialJS","s","id","js","fjs","getElementById","$body","previousWidth","node","offsetWidth","graphic","setupStickyHeader","$header","$menu","$toggle","visible","w","max","clientWidth","h","clientHeight","addEventListener","footer"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACzXA;AAEA,IAAMA,QAAQ,GAAG;AAChBC,EAAAA,OAAO,EAAE;AAAA,WAAMC,SAAS,CAACC,SAAV,CAAoBC,KAApB,CAA0B,UAA1B,CAAN;AAAA,GADO;AAGhBC,EAAAA,UAAU,EAAE;AAAA,WAAMH,SAAS,CAACC,SAAV,CAAoBC,KAApB,CAA0B,aAA1B,CAAN;AAAA,GAHI;AAKhBE,EAAAA,GAAG,EAAE;AAAA,WAAMJ,SAAS,CAACC,SAAV,CAAoBC,KAApB,CAA0B,mBAA1B,CAAN;AAAA,GALW;AAOhBG,EAAAA,KAAK,EAAE;AAAA,WAAML,SAAS,CAACC,SAAV,CAAoBC,KAApB,CAA0B,aAA1B,CAAN;AAAA,GAPS;AAShBI,EAAAA,OAAO,EAAE;AAAA,WAAMN,SAAS,CAACC,SAAV,CAAoBC,KAApB,CAA0B,WAA1B,CAAN;AAAA,GATO;AAWhBK,EAAAA,GAAG,EAAE;AAAA,WACJT,QAAQ,CAACC,OAAT,MACAD,QAAQ,CAACK,UAAT,EADA,IAEAL,QAAQ,CAACM,GAAT,EAFA,IAGAN,QAAQ,CAACO,KAAT,EAHA,IAIAP,QAAQ,CAACQ,OAAT,EALI;AAAA;AAXW,CAAjB;eAoBeR;;;;;;;;;ACtBf,IAAIU,gBAAgB,GAAG,KAAvB;AAEA;;AACA,SAASC,MAAT,GAAkB,CAAE,EAEpB;AAEA;;;AACA,SAASC,YAAT,GAAwB;AAEtB;AACA,MAAIC,KAAK,GAAG,CACVC,KADU,EAEVC,KAFU,EAGVC,KAHU,EAIVC,KAJU,EAKVC,KALU,EAMVC,KANU,EAOVC,KAPU,CAQV;AARU,GAAZ,CAHsB,CActB;;AACA,MAAIC,OAAO,GAAGC,EAAE,CAACC,MAAH,CAAU,eAAV,EACXC,EADW,CACR,OADQ,EACC,YAAY;AACvBC,IAAAA,WAAW,GAAGA,WAAW,GAAG,CAA5B;AACAC,IAAAA,UAAU,CAACD,WAAD,CAAV;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACAN,IAAAA,EAAE,CAACO,KAAH,CAASC,eAAT;AACD,GANW,CAAd;AAOA,MAAIC,QAAQ,GAAGT,EAAE,CAACC,MAAH,CAAU,gBAAV,EACZC,EADY,CACT,OADS,EACA,YAAY;AACvBC,IAAAA,WAAW,GAAGA,WAAW,GAAG,CAA5B;AACAC,IAAAA,UAAU,CAACD,WAAD,CAAV;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACD,GALY,CAAf;AAMA,MAAII,OAAO,GAAGV,EAAE,CAACC,MAAH,CAAU,gBAAV,EACXC,EADW,CACR,OADQ,EACC,YAAY;AACvBC,IAAAA,WAAW,GAAGA,WAAW,GAAG,CAA5B;AACAC,IAAAA,UAAU,CAACD,WAAD,CAAV;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACAK,IAAAA,QAAQ,CAACC,aAAT,CAAuB,OAAvB,EAAgCC,cAAhC,CAA+C;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAA/C;AACD,GANW,CAAd,CA5BsB,CAqCrB;;AACD,WAAStB,KAAT,GAAiB;AACf,QAAIuB,UAAU,GAAGf,EAAE,CAACC,MAAH,CAAU,UAAV,EACdC,EADc,CACX,OADW,EACF,UAAUc,CAAV,EAAa;AAC1Bb,MAAAA,WAAW,GAAGA,WAAW,GAAG,CAA5B;AACAC,MAAAA,UAAU,CAACD,WAAD,CAAV;AACD,KAJgB,CAAjB,CADe,CAOf;;AACAH,IAAAA,EAAE,CAACC,MAAH,CAAU,UAAV,EAAsBgB,OAAtB,CAA8B,QAA9B,EAAuC,IAAvC,EARe,CAUb;;AACAjB,IAAAA,EAAE,CAACC,MAAH,CAAU,eAAV,EAA2BgB,OAA3B,CAAmC,QAAnC,EAA6C,IAA7C,EAXa,CAaf;;AACEjB,IAAAA,EAAE,CAACC,MAAH,CAAU,aAAV,EAAyBgB,OAAzB,CAAiC,QAAjC,EAA2C,IAA3C,EAda,CAgBf;;AACEjB,IAAAA,EAAE,CAACC,MAAH,CAAU,gBAAV,EAA4BgB,OAA5B,CAAoC,QAApC,EAA8C,KAA9C,EACGC,KADH,CACS,SADT,EACmB,GADnB;AAEAlB,IAAAA,EAAE,CAACC,MAAH,CAAU,iBAAV,EAA6BgB,OAA7B,CAAqC,QAArC,EAA+C,KAA/C,EACGC,KADH,CACS,SADT,EACmB,GADnB;AAGAlB,IAAAA,EAAE,CAACC,MAAH,CAAU,gBAAV,EACGkB,UADH,GAEGD,KAFH,CAES,OAFT,EAEiB,KAFjB,EAGGA,KAHH,CAGS,QAHT,EAGkB,IAHlB,EAIGA,KAJH,CAIS,SAJT,EAImB,GAJnB,EAKGA,KALH,CAKS,gBALT,EAK0B,MAL1B;AAMAlB,IAAAA,EAAE,CAACC,MAAH,CAAU,iBAAV,EACGkB,UADH,GAEGD,KAFH,CAES,MAFT,EAEgB,KAFhB,EAGGA,KAHH,CAGS,QAHT,EAGkB,IAHlB,EAIGA,KAJH,CAIS,SAJT,EAImB,GAJnB,EA5Ba,CAmCb;;AACAlB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CmB,KAA/C;AAGH;;AAED,WAAS3B,KAAT,GAAiB;AAEf;AACEO,IAAAA,EAAE,CAACC,MAAH,CAAU,UAAV,EACGC,EADH,CACM,OADN,EACe,IADf,EAHa,CAMf;;AACEF,IAAAA,EAAE,CAACC,MAAH,CAAU,aAAV,EAAyBgB,OAAzB,CAAiC,QAAjC,EAA2C,KAA3C,EAPa,CASf;;AACEjB,IAAAA,EAAE,CAACC,MAAH,CAAU,gBAAV,EAA4BgB,OAA5B,CAAoC,QAApC,EAA8C,IAA9C;AACAjB,IAAAA,EAAE,CAACC,MAAH,CAAU,iBAAV,EAA6BgB,OAA7B,CAAqC,QAArC,EAA+C,IAA/C;AAEAjB,IAAAA,EAAE,CAACC,MAAH,CAAU,gBAAV,EACGkB,UADH,GAEGE,QAFH,CAEY,IAFZ,EAGGH,KAHH,CAGS,SAHT,EAGmB,GAHnB,EAIGA,KAJH,CAIS,OAJT,EAIiB,KAJjB,EAKGA,KALH,CAKS,QALT,EAKkB,IALlB,EAMGA,KANH,CAMS,gBANT,EAM0B,MAN1B;AAOAlB,IAAAA,EAAE,CAACC,MAAH,CAAU,iBAAV,EACGkB,UADH,GAEGE,QAFH,CAEY,IAFZ,EAGGH,KAHH,CAGS,SAHT,EAGmB,GAHnB,EAIGA,KAJH,CAIS,MAJT,EAIgB,KAJhB,EAKGA,KALH,CAKS,QALT,EAKkB,IALlB;AAOFlB,IAAAA,EAAE,CAACC,MAAH,CAAU,gBAAV,EAA4BkB,UAA5B,GACGE,QADH,CACY,IADZ,EAEGH,KAFH,CAES,SAFT,EAEmB,CAFnB,EA3Be,CAmCf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;;AAGAlB,IAAAA,EAAE,CAACC,MAAH,CAAU,WAAV,EAAuBgB,OAAvB,CAA+B,QAA/B,EAAwC,IAAxC;AACAjB,IAAAA,EAAE,CAACC,MAAH,CAAU,WAAV,EACGiB,KADH,CACS,SADT,EACmB,CADnB;AAEAlB,IAAAA,EAAE,CAACC,MAAH,CAAU,WAAV,EAAuBkB,UAAvB,GACGG,KADH,CACS,GADT,EAEGD,QAFH,CAEY,GAFZ,EAGGH,KAHH,CAGS,SAHT,EAGmB,CAHnB,EAtDe,CA0Df;AACA;AACA;AACA;AACA;AASE;;AACAlB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CsB,WAA/C,GAA6D,CAA7D;AACAvB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CuB,IAA/C;AAEH;;AAED,WAAS9B,KAAT,GAAiB;AAChB;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACCM,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CmB,KAA/C;AACApB,IAAAA,EAAE,CAACC,MAAH,CAAU,uBAAV,EAAmCgB,OAAnC,CAA2C,QAA3C,EAAoD,IAApD,EA3BgB,CA4BhB;;AAEAjB,IAAAA,EAAE,CAACC,MAAH,CAAU,gBAAV,EAA4BkB,UAA5B,GACEE,QADF,CACW,IADX,EAEEH,KAFF,CAEQ,SAFR,EAEkB,CAFlB,EA9BgB,CAmCV;;AACNlB,IAAAA,EAAE,CAACC,MAAH,CAAU,mBAAV,EAA+BgB,OAA/B,CAAuC,QAAvC,EAAgD,KAAhD;AACAjB,IAAAA,EAAE,CAACC,MAAH,CAAU,WAAV,EAAuBgB,OAAvB,CAA+B,QAA/B,EAAwC,KAAxC;AACAjB,IAAAA,EAAE,CAACC,MAAH,CAAU,WAAV,EACEiB,KADF,CACQ,SADR,EACkB,CADlB,EAtCgB,CAyCf;;AACAlB,IAAAA,EAAE,CAACyB,SAAH,CAAa,cAAb,EAA6BR,OAA7B,CAAqC,QAArC,EAA8C,KAA9C,EA1Ce,CA4Cf;;AACDjB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CmB,KAA/C;AACApB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CsB,WAA/C,GAA6D,CAA7D;AAEA;;AAED,WAAS5B,KAAT,GAAiB;AAChB;AACAK,IAAAA,EAAE,CAACC,MAAH,CAAU,mBAAV,EAA+BgB,OAA/B,CAAuC,QAAvC,EAAgD,IAAhD,EAFgB,CAIf;;AACAjB,IAAAA,EAAE,CAACC,MAAH,CAAU,gBAAV,EAA4BkB,UAA5B,GACCE,QADD,CACU,IADV,EAECH,KAFD,CAEO,SAFP,EAEiB,CAFjB,EALe,CASf;;AACAlB,IAAAA,EAAE,CAACyB,SAAH,CAAa,cAAb,EAA6BR,OAA7B,CAAqC,QAArC,EAA8C,KAA9C,EAVe,CAWf;;AACAjB,IAAAA,EAAE,CAACyB,SAAH,CAAa,cAAb,EACGC,MADH,CACU,UAAUV,CAAV,EAAa;AACnB,aAAOA,CAAC,CAACW,SAAF,IAAe,OAAtB;AACD,KAHH,EAIGV,OAJH,CAIW,QAJX,EAIoB,IAJpB,EAZe,CAoBhB;;AACAjB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CuB,IAA/C,GArBgB,CAsBjB;;AACCxB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CmB,KAA/C;AACApB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CsB,WAA/C,GAA6D,CAA7D;AAEA;;AAED,WAAS3B,KAAT,GAAiB;AAEf;AACAI,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CmB,KAA/C;AACApB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CsB,WAA/C,GAA6D,CAA7D,CAJe,CAKhB;;AACCvB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CuB,IAA/C,GANe,CAOf;;AACAxB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CmB,KAA/C;AACApB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CsB,WAA/C,GAA6D,CAA7D,CATe,CAWf;;AACAvB,IAAAA,EAAE,CAACyB,SAAH,CAAa,cAAb,EAA6BR,OAA7B,CAAqC,QAArC,EAA8C,KAA9C,EAZe,CAcf;;AACAjB,IAAAA,EAAE,CAACyB,SAAH,CAAa,cAAb,EACGC,MADH,CACU,UAAUV,CAAV,EAAa;AACnB,aAAOA,CAAC,CAACW,SAAF,IAAe,OAAtB;AACD,KAHH,EAIGV,OAJH,CAIW,QAJX,EAIoB,IAJpB,EAfe,CAqBf;;AACEjB,IAAAA,EAAE,CAACyB,SAAH,CAAa,eAAb,EACGN,UADH,GAEGE,QAFH,CAEY,IAFZ,EAGGH,KAHH,CAGS,OAHT,EAGiB,qBAHjB;AAIH;;AAGD,WAASrB,KAAT,GAAiB;AAEf;AACDG,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CmB,KAA/C;AACApB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CsB,WAA/C,GAA6D,CAA7D,CAJgB,CAKhB;;AACAvB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CuB,IAA/C,GANgB,CAOhB;;AACAxB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CmB,KAA/C;AACApB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CsB,WAA/C,GAA6D,CAA7D,CATgB,CAWhB;;AACCvB,IAAAA,EAAE,CAACyB,SAAH,CAAa,cAAb,EAA6BR,OAA7B,CAAqC,QAArC,EAA8C,KAA9C,EAZe,CAchB;;AACCjB,IAAAA,EAAE,CAACyB,SAAH,CAAa,cAAb,EACGC,MADH,CACU,UAAUV,CAAV,EAAa;AACnB,aAAOA,CAAC,CAACW,SAAF,IAAe,OAAtB;AACD,KAHH,EAIGV,OAJH,CAIW,QAJX,EAIoB,IAJpB,EAfe,CAqBf;;AACAW,IAAAA,YAAY,GAtBG,CAwBf;;AACE5B,IAAAA,EAAE,CAACyB,SAAH,CAAa,eAAb,EACGN,UADH,GAEGE,QAFH,CAEY,IAFZ,EAGGH,KAHH,CAGS,OAHT,EAGiB,SAHjB,EAzBa,CA8Bf;;AACElB,IAAAA,EAAE,CAACC,MAAH,CAAU,iBAAV,EAA6BgB,OAA7B,CAAqC,QAArC,EAA+C,IAA/C;AACCjB,IAAAA,EAAE,CAACC,MAAH,CAAU,gBAAV,EAA4BgB,OAA5B,CAAoC,QAApC,EAA8C,IAA9C,EAhCY,CAkCb;AAEF;;AACEjB,IAAAA,EAAE,CAACC,MAAH,CAAU,iBAAV,EAA6BgB,OAA7B,CAAqC,QAArC,EAA+C,KAA/C;AACAjB,IAAAA,EAAE,CAACC,MAAH,CAAU,iBAAV,EAA6BkB,UAA7B,GACGD,KADH,CACS,SADT,EACmB,GADnB,EAtCa,CAyCf;;AACElB,IAAAA,EAAE,CAACC,MAAH,CAAU,iBAAV,EACGiB,KADH,CACS,SADT,EACmB,IADnB,EAEGC,UAFH,GAGGE,QAHH,CAGY,IAHZ,EAIGH,KAJH,CAIS,MAJT,EAIgB,KAJhB,EAKGA,KALH,CAKS,QALT,EAKkB,IALlB,EAMGA,KANH,CAMS,SANT,EAMmB,GANnB;AAOAlB,IAAAA,EAAE,CAACC,MAAH,CAAU,gBAAV,EAA4BkB,UAA5B,GACGE,QADH,CACY,IADZ,EAEGH,KAFH,CAES,OAFT,EAEiB,KAFjB,EAGGA,KAHH,CAGS,QAHT,EAGkB,IAHlB,EAIGA,KAJH,CAIS,SAJT,EAImB,GAJnB;AAMH;;AAED,WAASpB,KAAT,GAAiB;AAEf;AACDE,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CmB,KAA/C;AACApB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CsB,WAA/C,GAA6D,CAA7D,CAJgB,CAKhB;;AACAvB,IAAAA,EAAE,CAACC,MAAH,CAAU,kBAAV,EAA8B,SAA9B,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CuB,IAA/C,GANgB,CAQhB;;AACCxB,IAAAA,EAAE,CAACyB,SAAH,CAAa,cAAb,EAA6BR,OAA7B,CAAqC,QAArC,EAA8C,KAA9C,EATe,CAWhB;;AACCjB,IAAAA,EAAE,CAACyB,SAAH,CAAa,cAAb,EACGC,MADH,CACU,UAAUV,CAAV,EAAa;AACnB,aAAOA,CAAC,CAACW,SAAF,IAAe,OAAtB;AACD,KAHH,EAIGV,OAJH,CAIW,QAJX,EAIoB,IAJpB;AAMAY,IAAAA,MAAM,CAACC,UAAP,CAAkB,UAASd,CAAT,EAAW;AAG3B,UAAG,CAAC5B,gBAAJ,EAAqB;AAAA,YAMV2C,WANU,GAMnB,SAASA,WAAT,CAAqBC,MAArB,EAA6B;AAC3B5C,UAAAA,gBAAgB,GAAG,IAAnB;AACA,iBAAO,YAAW;AAChB,gBAAI6C,CAAC,GAAGjC,EAAE,CAACkC,iBAAH,CAAqBL,MAAM,CAACM,WAAP,IAAsBxB,QAAQ,CAACyB,eAAT,CAAyBC,SAApE,EAA+EL,MAA/E,CAAR;AACA,mBAAO,UAASM,CAAT,EAAY;AAAEC,cAAAA,QAAQ,CAAC,CAAD,EAAIN,CAAC,CAACK,CAAD,CAAL,CAAR;AAAoB,aAAzC;AACD,WAHD;AAID,SAZkB;;AACnBtC,QAAAA,EAAE,CAACmB,UAAH,GACKG,KADL,CACW,CADX,EAEKD,QAFL,CAEc,IAFd,EAGKmB,KAHL,CAGW,QAHX,EAGqBT,WAAW,CAACF,MAAM,CAACY,WAAR,CAHhC;AAYD,OAhB0B,CAsB3B;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEAzC,MAAAA,EAAE,CAACC,MAAH,CAAU,SAAV,EAAqBgB,OAArB,CAA6B,QAA7B,EAAsC,IAAtC,EACGyB,IADH,CACQ,SADR,EACkB,QADlB;AAEA1C,MAAAA,EAAE,CAACC,MAAH,CAAU,QAAV,EAAoBgB,OAApB,CAA4B,QAA5B,EAAqC,IAArC,EArC2B,CAsC3B;;AACAjB,MAAAA,EAAE,CAACyB,SAAH,CAAa,cAAb,EAA6BR,OAA7B,CAAqC,QAArC,EAA8C,KAA9C,EAvC2B,CAyC3B;;AAEA,UAAI0B,OAAO,GAAG3C,EAAE,CAACC,MAAH,CAAU,eAAV,EACXC,EADW,CACR,OADQ,EACC,YAAY;AACvBC,QAAAA,WAAW,GAAGA,WAAW,GAAG,CAA5B;AACAC,QAAAA,UAAU,CAACD,WAAD,CAAV;AACD,OAJW,CAAd;AAMAH,MAAAA,EAAE,CAACC,MAAH,CAAU,eAAV,EACGgB,OADH,CACW,QADX,EACoB,IADpB;AAGAjB,MAAAA,EAAE,CAACC,MAAH,CAAU,eAAV,EAA2BkB,UAA3B,GACGE,QADH,CACY,IADZ,EAEGH,KAFH,CAES,SAFT,EAEmB,CAFnB,EApD2B,CAwD3B;AAEA;AAED,KA5DD,EA4DE,IA5DF,EAlBe,CAgFf;AACE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;AACAlB,IAAAA,EAAE,CAACC,MAAH,CAAU,iBAAV,EACGgB,OADH,CACW,QADX,EACoB,KADpB,EAEGC,KAFH,CAES,SAFT,EAEmB,MAFnB,EAGGA,KAHH,CAGS,SAHT,EAGmB,GAHnB,EA5He,CAkIf;AACA;AAID;;AAEC,WAAS0B,KAAT,GAAiB,CAmDlB,CAnDC,CACE;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIJ;AAEA;;;AACA,WAAShB,YAAT,GAAwB;AACpB,QAAIiB,WAAW,GAAGlC,QAAQ,CAACmC,sBAAT,CAAgC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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIN;AACO,GApK+D,CAsKtE;;AACC,EAED;;;AAEA,SAASO,qBAAT,CAA+BC,QAA/B,EAAwCL,aAAxC,EAAsDC,aAAtD,EAAqE;AAC/D;AAEA;AACFjH,EAAAA,EAAE,CAAC4G,IAAH,CAAQS,QAAR,EAAkBjE,IAAlB,EACA;AACA,WAASkE,YAAT,CAAsBhE,UAAtB,EAAkC;AAChC,QAAIiE,gBAAgB,GAAGjE,UAAU,CAAC6B,GAAX,CAAe,UAAUnE,CAAV,EAAa;AAAC,aAAOA,CAAC,CAACkG,mBAAT;AAA6B,KAA1D,CAAvB,CADgC,CAIhC;;AACA,QAAIM,UAAU,GAAGxH,EAAE,CAACyH,YAAH,GACdhC,MADc,CACP,CAAC,MAAD,EAAQ,UAAR,EAAmB,QAAnB,EAA4B,WAA5B,EAAwC,QAAxC,EAAiD,MAAjD,EAAwD,QAAxD,CADO,EAEdC,KAFc,CAER,CAAC,SAAD,EAAW,SAAX,EAAqB,SAArB,EAA+B,SAA/B,EAAyC,SAAzC,EAAmD,OAAnD,EAA2D,MAA3D,CAFQ,CAAjB;AAKA,QAAI3B,SAAS,GAAG/D,EAAE,CAACC,MAAH,CAAU+G,aAAV,CAAhB,CAVgC,CAYhC;;AACA,QAAIU,KAAK,GAAG3D,SAAS,CAACtC,SAAV,CAAoB,MAApB,EACTgC,IADS,CACJH,UADI,EAETI,KAFS,GAEDF,MAFC,CAEM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","file":"main.js","sourceRoot":"../src/js","sourcesContent":["/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = debounce;\n","// device sniffing for mobile\n\nconst isMobile = {\n\tandroid: () => navigator.userAgent.match(/Android/i),\n\n\tblackberry: () => navigator.userAgent.match(/BlackBerry/i),\n\n\tios: () => navigator.userAgent.match(/iPhone|iPad|iPod/i),\n\n\topera: () => navigator.userAgent.match(/Opera Mini/i),\n\n\twindows: () => navigator.userAgent.match(/IEMobile/i),\n\n\tany: () => (\n\t\tisMobile.android() ||\n\t\tisMobile.blackberry() ||\n\t\tisMobile.ios() ||\n\t\tisMobile.opera() ||\n\t\tisMobile.windows()\n\t),\n}\n\nexport default isMobile\n","var stepperTriggered = false;\n\n/* global d3 */\nfunction resize() {}\n\n//----------------//\n\n//building the stepper\nfunction setupStepper() {\n\n  //array of step states\n  var steps = [\n    step0,\n    step1,\n    step2,\n    step3,\n    step4,\n    step5,\n    step6\n    // step7\n  ]\n\n  //define click events on right-left buttons\n  var tapLeft = d3.select('svg.tap--left')\n    .on('click', function () {\n      currentStep = currentStep - 1\n      switchStep(currentStep)\n      console.log('clicked')\n      d3.event.stopPropagation()\n    })\n  var tapRight = d3.select('svg.tap--right')\n    .on('click', function () {\n      currentStep = currentStep + 1\n      switchStep(currentStep)\n      console.log('clicked')\n    })\n  var tapDown = d3.select('svg.tap--final')\n    .on('click', function () {\n      currentStep = currentStep + 1\n      switchStep(currentStep)\n      console.log('clicked')\n      document.querySelector('.step').scrollIntoView({ behavior: 'smooth' })\n    })\n\n\n   // define each step\n  function step0() {\n    var entirePage = d3.select('.stepper')\n      .on('click', function (d) {\n      currentStep = currentStep + 1\n      switchStep(currentStep)\n    })\n\n    //activate container\n    d3.select('.stepper').classed('active',true)\n\n      //Activate stepper tap\n      d3.select(\".stepper__tap\").classed(\"active\", true)\n\n    //Activate first-button\n      d3.select(\".tap--first\").classed(\"active\", true)\n\n    //Deactivate right-left click buttons\n      d3.select(\".tap.tap--left\").classed(\"active\", false)\n        .style('opacity','0')\n      d3.select(\".tap.tap--right\").classed(\"active\", false)\n        .style('opacity','0')\n\n      d3.select(\".tap.tap--left\")\n        .transition()\n        .style('right','55%')\n        .style('bottom','5%')\n        .style('opacity','0')\n        .style('pointer-events','none')\n      d3.select(\".tap.tap--right\")\n        .transition()\n        .style('left','55%')\n        .style('bottom','5%')\n        .style('opacity','0')\n\n\n      //stop the first video on clickback\n      d3.select('video.ismo.step1')['_groups'][0][0].pause()\n\n\n  }\n\n  function step1() {\n\n    //Remove full page click\n      d3.select('.stepper')\n        .on('click', null)\n\n    //Dectivate first-button\n      d3.select(\".tap--first\").classed(\"active\", false)\n\n    //Activate right-left click buttons\n      d3.select(\".tap.tap--left\").classed(\"active\", true)\n      d3.select(\".tap.tap--right\").classed(\"active\", true)\n\n      d3.select(\".tap.tap--left\")\n        .transition()\n        .duration(1000)\n        .style('opacity','1')\n        .style('right','55%')\n        .style('bottom','5%')\n        .style('pointer-events','auto')\n      d3.select(\".tap.tap--right\")\n        .transition()\n        .duration(1000)\n        .style('opacity','1')\n        .style('left','55%')\n        .style('bottom','5%')\n\n    d3.select('.pause-overlay').transition()\n      .duration(1500)\n      .style('opacity',0)\n\n\n\n\n\n    // function splitSubtitle() {\n    // var subtitleWords = document.getElementsByClassName('subtitle')[0]\n    // subtitleWords.innerHTML = \"<span>\".concat(subtitleWords.innerHTML)\n    // console.log(subtitleWords.innerHTML)\n    // subtitleWords.innerHTML = subtitleWords.innerHTML.replace(/ /g,\"</span> <span>\")\n    // console.log(subtitleWords.innerHTML)\n    // subtitleWords.innerHTML = subtitleWords.innerHTML.slice(0,-7)\n    // d3.selectAll('.subtitle>span').classed('subtitle-word',true)\n\n    // splitSubtitle = function() {}\n\n    // }\n\n    // splitSubtitle()\n\n\n    d3.select('.subtitle').classed('active',true)\n    d3.select('.subtitle')\n      .style('opacity',0)\n    d3.select('.subtitle').transition()\n      .delay(400)\n      .duration(150)\n      .style('opacity',1)\n    // var subtitleHighlights = d3.selectAll('.subtitle-word')\n    // subtitleHighlights.transition()\n    //   .delay(400)\n    //   .duration(200)\n    //   .style('color','white')\n\n\n\n\n\n\n\n\n      //play the first video\n      d3.select('video.ismo.step1')['_groups'][0][0].currentTime = 0\n      d3.select('video.ismo.step1')['_groups'][0][0].play()\n\n  }\n\n  function step2() {\n   // //activate script\n   // d3.select('.script-container').classed(\"active\",true)\n   //  .transition()\n   //  .duration(1000)\n\n   //  //deselct active text on clickback\n   //  d3.selectAll('.script-line').classed(\"active\",false)\n   //  //select active text\n   //  d3.selectAll('.script-line')\n   //    .filter(function (d) {\n   //      return d.step_used == 'step2'\n   //    })\n   //    .classed('active',true)\n\n\n  //  //stop the first video\n  //  d3.select('video.ismo.step1')['_groups'][0][0].pause()\n  //  d3.select('video.ismo.step1')['_groups'][0][0].currentTime = 0\n  //  //play the second video\n  //  d3.select('video.ismo.step2')['_groups'][0][0].play()\n  // //pause the third video on clickback\n  //  d3.select('video.ismo.step3')['_groups'][0][0].pause()\n  //  d3.select('video.ismo.step3')['_groups'][0][0].currentTime = 0\n\n  //stop the first video\n   d3.select('video.ismo.step1')['_groups'][0][0].pause()\n   d3.select('.stepper__video.step1').classed('active',true)\n   // d3.select('video.ismo.step1')['_groups'][0][0].currentTime = 0\n\n   d3.select('.pause-overlay').transition()\n    .duration(1500)\n    .style('opacity',1)\n\n\n         //deactivate script on clickback\n   d3.select('.script-container').classed(\"active\",false)\n   d3.select('.subtitle').classed('active',false)\n   d3.select('.subtitle')\n    .style('opacity',0)\n\n    //deselect active text on clickback\n    d3.selectAll('.script-line').classed(\"active\",false)\n\n    //stop the second video on clickback\n   d3.select('video.ismo.step3')['_groups'][0][0].pause()\n   d3.select('video.ismo.step3')['_groups'][0][0].currentTime = 0\n\n  }\n\n  function step3() {\n   //activate script\n   d3.select('.script-container').classed(\"active\",true)\n\n    //transition out overlay\n    d3.select('.pause-overlay').transition()\n    .duration(2000)\n    .style('opacity',0)\n\n    //deselct active text on clickback\n    d3.selectAll('.script-line').classed(\"active\",false)\n    //select active text\n    d3.selectAll('.script-line')\n      .filter(function (d) {\n        return d.step_used == 'step2'\n      })\n      .classed('active',true)\n\n\n\n   //play the second video\n   d3.select('video.ismo.step3')['_groups'][0][0].play()\n  //pause the third video on clickback\n   d3.select('video.ismo.step4')['_groups'][0][0].pause()\n   d3.select('video.ismo.step4')['_groups'][0][0].currentTime = 0\n\n  }\n\n  function step4() {\n\n    //stop the second video\n    d3.select('video.ismo.step3')['_groups'][0][0].pause()\n    d3.select('video.ismo.step3')['_groups'][0][0].currentTime = 0\n   //play the third video\n    d3.select('video.ismo.step4')['_groups'][0][0].play()\n    //pause the fourth video on clickback\n    d3.select('video.ismo.step5')['_groups'][0][0].pause()\n    d3.select('video.ismo.step5')['_groups'][0][0].currentTime = 0\n\n    //deselect active text on clickback/clickthrough\n    d3.selectAll('.script-line').classed(\"active\",false)\n\n    //select active text\n    d3.selectAll('.script-line')\n      .filter(function (d) {\n        return d.step_used == 'step3'\n      })\n      .classed('active',true)\n\n    //reset text color on clickback\n      d3.selectAll('#ass-instance')\n        .transition()\n        .duration(1000)\n        .style('color','rgba(0,255,243,0.4)')\n  }\n\n\n  function step5() {\n\n    //stop the third video\n   d3.select('video.ismo.step4')['_groups'][0][0].pause()\n   d3.select('video.ismo.step4')['_groups'][0][0].currentTime = 0\n   //play the fourth video\n   d3.select('video.ismo.step5')['_groups'][0][0].play()\n   //pause the fifth video on clickback\n   d3.select('video.ismo.step6')['_groups'][0][0].pause()\n   d3.select('video.ismo.step6')['_groups'][0][0].currentTime = 0\n\n   //deselect active text on clickback/clickthrough\n    d3.selectAll('.script-line').classed(\"active\",false)\n\n   //select active text\n    d3.selectAll('.script-line')\n      .filter(function (d) {\n        return d.step_used == 'step4'\n      })\n      .classed('active',true)\n\n    //highlight instances of ass\n    highlightAss()\n\n    //reset text color on clickback\n      d3.selectAll('#ass-instance')\n        .transition()\n        .duration(1000)\n        .style('color','#00fff3')\n\n    //Reactivate right click buttons on clickback\n      d3.select(\".tap.tap--right\").classed(\"active\", true)\n       d3.select(\".tap.tap--left\").classed(\"active\", true)\n\n      //Move left tap to top corner\n\n    //Deactivate final click button on clickback\n      d3.select(\".tap.tap--final\").classed(\"active\", false)\n      d3.select(\".tap.tap--final\").transition()\n        .style('opacity','0')\n\n    //Move back right-left click buttons\n      d3.select(\".tap.tap--right\")\n        .style(\"display\",null)\n        .transition()\n        .duration(1000)\n        .style('left','55%')\n        .style('bottom','5%')\n        .style('opacity','1')\n      d3.select('.tap.tap--left').transition()\n        .duration(1000)\n        .style('right','55%')\n        .style('bottom','5%')\n        .style('opacity','1')\n\n  }\n\n  function step6() {\n\n    //stop the fourth video\n   d3.select('video.ismo.step5')['_groups'][0][0].pause()\n   d3.select('video.ismo.step5')['_groups'][0][0].currentTime = 0\n   //play the fifth video\n   d3.select('video.ismo.step6')['_groups'][0][0].play()\n\n   //deselect active text on clickback/clickthrough\n    d3.selectAll('.script-line').classed(\"active\",false)\n\n   //select active text\n    d3.selectAll('.script-line')\n      .filter(function (d) {\n        return d.step_used == 'step5'\n      })\n      .classed('active',true)\n\n    window.setTimeout(function(d){\n\n\n      if(!stepperTriggered){\n        d3.transition()\n            .delay(0)\n            .duration(1000)\n            .tween(\"scroll\", scrollTween(window.innerHeight));\n\n        function scrollTween(offset) {\n          stepperTriggered = true;\n          return function() {\n            var i = d3.interpolateNumber(window.pageYOffset || document.documentElement.scrollTop, offset);\n            return function(t) { scrollTo(0, i(t)); };\n          };\n        }\n      }\n\n\n\n\n\n      ////remove the stepper and activate the scroller\n      //d3.select('.stepper__graphics').classed('active',false)\n      //  .attr('display','none')\n\n      // d3.select('.stepper').classed('active',false)\n      // d3.select('.script-container')\n      //   .classed('active',false)\n      // d3.select('.tap.tap--final')\n      //   .classed('active',false)\n      // d3.select(\".tap.tap--final\").transition()\n      //   .duration(1000)\n      //   .style('opacity',0)\n\n      d3.select('.scroll').classed('active',true)\n        .attr('display','inline')\n      d3.select('.stack').classed('active',true)\n      //deselect active text on clickback/clickthrough\n      d3.selectAll('.script-line').classed(\"active\",false)\n\n      //activate tap back button\n\n      var tapBack = d3.select('svg.tap--back')\n        .on('click', function () {\n          currentStep = currentStep - 1\n          switchStep(currentStep)\n        })\n\n      d3.select('svg.tap--back')\n        .classed('active',true)\n\n      d3.select('svg.tap--back').transition()\n        .duration(1000)\n        .style('opacity',1)\n\n      //pause the fifth video\n\n      // d3.select('video.ismo.step6')['_groups'][0][0].pause()\n\n    },3000)\n\n    //Move out right-left click buttons\n      // d3.select(\".tap.tap--right\").transition()\n      //   .duration(1000)\n      //   .style('left','65%')\n      //   .style('bottom','20%')\n      //   .style('opacity','.6')\n      // d3.select('.tap.tap--left').transition()\n      //   .duration(1000)\n      //   .style('right','65%')\n      //   .style('bottom','20%')\n      //   .style('opacity','.6')\n\n    // //Activate final click button\n    //   d3.select(\".tap.tap--final\").classed(\"active\", true)\n    //\n    //   d3.select(\".tap.tap--final\").transition()\n    //     .duration(1)\n    //     .style('opacity',0)\n    //\n    //   d3.select(\".tap.tap--final\").transition()\n    //     .duration(1000)\n    //     .style('opacity',1)\n\n    // //Dectivate clickback button on clickback\n    //   d3.select(\".tap.tap--back\").classed(\"active\", false)\n    //\n    //   //Reactivate left-right click on clickback\n    //   d3.select('.tap.tap--left').classed('active',true)\n    //   d3.select(\".tap.tap--right\").classed(\"active\", true)\n    //\n    //     //reactivate on clickback\n    //   d3.select('.stepper').classed('active',true)\n    //   d3.select('.stepper__graphics').classed('active',true)\n    //     .attr('display','none')\n    //   d3.select('.script-container')\n    //     .classed('active',true)\n    //\n    //   //deactivate scroller and stack on clickback\n    //   d3.select('.scroll').classed('active',false)\n    //   d3.select('.stack').classed('active',false)\n\n    //deactivate leftright click button\n    // d3.select('.tap.tap--left')\n    //   .classed('active',false)\n    d3.select('.tap.tap--right')\n      .classed('active',false)\n      .style(\"display\",\"none\")\n      .style('opacity','0')\n\n\n    // d3.select('.tap.tap--left').transition()\n    //   .style('opacity','0')\n\n\n\n  }\n\n    function step7() {\n      //remove the stepper and activate the scroller\n      // d3.select('.stepper__graphics').classed('active',false)\n      //   .attr('display','none')\n\n      // d3.select('.stepper').classed('active',false)\n      // d3.select('.script-container')\n      //   .classed('active',false)\n      // d3.select('.tap.tap--final')\n      //   .classed('active',false)\n      // d3.select(\".tap.tap--final\").transition()\n      //   .duration(1000)\n      //   .style('opacity',0)\n      //\n      // d3.select('.scroll').classed('active',true)\n      //   .attr('display','inline')\n      // d3.select('.stack').classed('active',true)\n      // //deselect active text on clickback/clickthrough\n      // d3.selectAll('.script-line').classed(\"active\",false)\n      //\n      // //activate tap back button\n      //\n      //   var tapBack = d3.select('svg.tap--back')\n      //     .on('click', function () {\n      //       currentStep = currentStep - 1\n      //       switchStep(currentStep)\n      //       console.log('clicked')\n      //     })\n      //\n      // d3.select('svg.tap--back')\n      //   .classed('active',true)\n      //\n      // d3.select('svg.tap--back').transition()\n      //   .duration(1000)\n      //   .style('opacity',1)\n      //\n      // //pause the fifth video\n      // d3.select('video.ismo.step6')['_groups'][0][0].pause()\n      //\n      // //deactivate leftright click button\n      // d3.select('.tap.tap--left')\n      //   .classed('active',false)\n      // d3.select('.tap.tap--right')\n      //   .classed('active',false)\n      //\n      // d3.select('.tap.tap--left').transition()\n      //   .style('opacity','0')\n      // d3.select('.tap.tap--right').transition()\n      //   .style('opacity','0')\n\n\n  }\n  //end of step functions\n\n  //highlight asses function\n  function highlightAss() {\n      var scriptLines = document.getElementsByClassName('script-line')\n      var x\n      for (x of scriptLines) {\n        x.innerHTML = x.innerHTML.replace(/ass-berg/g,'<span id=\"ass-instance\">ass-berg</span>');\n        x.innerHTML = x.innerHTML.replace(/badass/g,'<span id=\"ass-instance\">badass</span>');\n        x.innerHTML = x.innerHTML.replace(/dumbass/g,'<span id=\"ass-instance\">dumbass</span>');\n        x.innerHTML = x.innerHTML.replace(/your ass/g,'<span id=\"ass-instance\">your ass</span>');\n        x.innerHTML = x.innerHTML.replace(/Your ass/g,'<span id=\"ass-instance\">Your ass</span>');\n        x.innerHTML = x.innerHTML.replace(/my ass/g,'<span id=\"ass-instance\">my ass</span>');\n        x.innerHTML = x.innerHTML.replace(/My ass/g,'<span id=\"ass-instance\">My ass</span>');\n        x.innerHTML = x.innerHTML.replace(/half-assed/g,'<span id=\"ass-instance\">half-assed</span>');\n        x.innerHTML = x.innerHTML.replace(/blue-ass/g,'<span id=\"ass-instance\">blue-ass</span>');\n        x.innerHTML = x.innerHTML.replace(/long-ass/g,'<span id=\"ass-instance\">long-ass</span>');\n        x.innerHTML = x.innerHTML.replace(/good-ass/g,'<span id=\"ass-instance\">good-ass</span>');\n        x.innerHTML = x.innerHTML.replace(/grown-ass/g,'<span id=\"ass-instance\">grown-ass</span>');\n        x.innerHTML = x.innerHTML.replace(/lazy-ass/g,'<span id=\"ass-instance\">lazy-ass</span>');\n        x.innerHTML = x.innerHTML.replace(/piece of ass/g,'<span id=\"ass-instance\">piece of ass</span>');\n        x.innerHTML = x.innerHTML.replace(/ ass\\./g,' <span id=\"ass-instance\">ass</span>.');\n        x.innerHTML = x.innerHTML.replace(/ass/g,'<span id=\"ass-instance\">ass</span>');\n        x.innerHTML = x.innerHTML.replace(/ass./g,'<span id=\"ass-instance\">ass</span>.');\n        x.innerHTML = x.innerHTML.replace(/ ass,/g,' <span id=\"ass-instance\">ass</span>,');\n        x.innerHTML = x.innerHTML.replace(/ ass /g,' <span id=\"ass-instance\">ass</span> ');\n      }\n      highlightAss = function(){}\n\n    }\n  //end of highlight asses function\n\n    //keep only asses function\n  function assOnlyScript() {\n      var scriptLines = document.getElementsByClassName('scroll-script-line')\n      var x\n      for (x of scriptLines) {\n        x.innerHTML = x.innerHTML.replace(/ass-berg/g,'<span id=\"ass-instance\">ass-berg</span>');\n        x.innerHTML = x.innerHTML.replace(/badass/g,'<span id=\"ass-instance\">badass</span>');\n        x.innerHTML = x.innerHTML.replace(/dumbass/g,'<span id=\"ass-instance\">dumbass</span>');\n        x.innerHTML = x.innerHTML.replace(/your ass/g,'<span id=\"ass-instance\">your ass</span>');\n        x.innerHTML = x.innerHTML.replace(/Your ass/g,'<span id=\"ass-instance\">Your ass</span>');\n        x.innerHTML = x.innerHTML.replace(/my ass/g,'<span id=\"ass-instance\">my ass</span>');\n        x.innerHTML = x.innerHTML.replace(/My ass/g,'<span id=\"ass-instance\">My ass</span>');\n        x.innerHTML = x.innerHTML.replace(/half-assed/g,'<span id=\"ass-instance\">half-assed</span>');\n        x.innerHTML = x.innerHTML.replace(/blue-ass/g,'<span id=\"ass-instance\">blue-ass</span>');\n        x.innerHTML = x.innerHTML.replace(/long-ass/g,'<span id=\"ass-instance\">long-ass</span>');\n        x.innerHTML = x.innerHTML.replace(/good-ass/g,'<span id=\"ass-instance\">good-ass</span>');\n        x.innerHTML = x.innerHTML.replace(/grown-ass/g,'<span id=\"ass-instance\">grown-ass</span>');\n        x.innerHTML = x.innerHTML.replace(/lazy-ass/g,'<span id=\"ass-instance\">lazy-ass</span>');\n        x.innerHTML = x.innerHTML.replace(/piece of ass/g,'<span id=\"ass-instance\">piece of ass</span>');\n        x.innerHTML = x.innerHTML.replace(/ ass\\./g,' <span id=\"ass-instance\">ass</span>.');\n        x.innerHTML = x.innerHTML.replace(/ass/g,'<span id=\"ass-instance\">ass</span>');\n        x.innerHTML = x.innerHTML.replace(/ass./g,'<span id=\"ass-instance\">ass</span>.');\n        x.innerHTML = x.innerHTML.replace(/ ass,/g,' <span id=\"ass-instance\">ass</span>,');\n        x.innerHTML = x.innerHTML.replace(/ ass /g,' <span id=\"ass-instance\">ass</span> ');\n      }\n      assOnlyScript = function(){}\n\n    }\n  //end of highlight asses function\n\n  //change step function\n  function switchStep(currentStep){\n      //activate the current step\n      d3.selectAll(\".stepper__annotation\").classed(\"active\", false);\n      d3.select(\".stepper__annotation.step\" + currentStep).classed(\"active\", true);\n      d3.selectAll(\".stepper__video\").classed(\"active\", false);\n      d3.select(\".stepper__video.step\" + currentStep).classed(\"active\", true);\n      d3.selectAll(\".stepper__intro\").classed(\"active\", false);\n      d3.select(\".stepper__intro.step\" + currentStep).classed(\"active\", true);\n      //console.log(steps[(\"step\" + currentStep)])\n\n      //run that step\n      steps[(currentStep)]()\n\n    }\n  //end of change step function\n\n  //initalize stepper\n  var currentStep = 0\n  switchStep(currentStep)\n\n//end of stepper function\n}\n\n//-------------//\n\n//define the data, run script function\nd3.csv('assets/data/ismo_script.csv').then(\n//begin script function\nfunction setupStepperScript(datapoints) {\n\n  var scriptContainer = d3.select('.stepper__graphics')\n    .append('p')\n    .attr('class','script-container')\n\n  var scriptLines = scriptContainer.selectAll('span')\n    .data(datapoints)\n    .enter().append('span')\n    .attr('class','script-line')\n    .text(function (d){\n      return (d.text + \" \")\n})\n//end of script function\n}).catch(function(error){\n     // handle error\n  })\n//end of data read/script\n\n\nfunction setupAssLine(datapoints,container) {\n\n\n  if (datapoints.length > 1) {\n    var citationData = datapoints;\n\n    console.log(citationData);\n\n    //set up variables\n    const margin = { top: 20, right: 26, bottom: 20, left: 26 }\n    const height = (window.innerHeight - margin.top - margin.bottom) / 2\n    const width = window.innerWidth - margin.left - margin.right\n\n    var sliderContainer = container.append('div')\n      .attr('class','slider-container')\n\n    var svg = container\n      .append('svg')\n      .attr('class','time-line')\n      .attr('width',width+margin.left+margin.right)\n      .attr('height',height+margin.bottom+margin.top)\n      .append(\"g\")\n      .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\n    var lineFunction = d3.line()\n      .x(function(d) { return d.x; })\n      .y(function(d) { return d.y; })\n\n    var lineData = [ { \"x\": 0,   \"y\": height*.02},  { \"x\": width,  \"y\": height*.02} ]\n\n\n\n    //filter data\n\n    var citationCounter = 0\n    for (var x of citationData){\n      if (x['@first'] == 'yes')\n        {citationData = citationData.slice(citationCounter,)}\n      citationCounter = citationCounter + 1\n    }\n    //grab just the dates\n    var citationDates = citationData.map(function (d) {return +d.date})\n    var firstDate = citationDates[0]\n    var lastDate = citationDates.slice(-1)[0]\n\n\n    //set up scales\n    var xPositionScale = d3.scaleLinear()\n      .domain([+firstDate,+lastDate])\n      .range([0,width])\n\n    var indexCounter = 0\n      //remove extraneous years\n     for (var x of citationDates) {\n      if (x.length > 4) {\n        var newDate = x.slice(0,4)\n        citationDates[indexCounter] = newDate\n      }\n      else {}\n      indexCounter = indexCounter + 1\n    }\n\n\n    //add the timeline\n    var timeLine = svg.append('line')\n        .attr(\"class\",\"background-bar\")\n        .attr(\"x1\",0)\n        .attr(\"x2\",width)\n        .attr(\"y1\",8)\n        .attr(\"y2\",8)\n        .attr('stroke-width',2)\n        .attr('stroke','#333333')\n\n    //add axis labels\n\n    var yearLabelStart = svg.append('g')\n        .attr('transform','translate(' + 0 +','+ 0 + ')')\n        .append('text')\n        .text(firstDate)\n        .attr('class','year-label')\n        ;\n\n    var yearLabelEnd = svg.append('g')\n      .attr('transform','translate(' + width +','+ 0 + ')')\n      .append('text')\n        .text(lastDate)\n        .attr('class','year-label')\n\n      //add circle for each citation\n    var citationCircles = svg.selectAll('.citation')\n        .data(citationData)\n        .enter()\n        .append('line')\n        .attr(\"class\",\"citation\")\n        .attr('x1',function (d) {\n          if (d.date.length >4)\n            {return  xPositionScale(d.date.slice(0,4))}\n          else\n            {return xPositionScale(d.date)}\n\n        })\n        .attr('x2',function (d) {\n          if (d.date.length >4)\n            {return  xPositionScale(d.date.slice(0,4))}\n          else\n            {return xPositionScale(d.date)}\n\n        })\n        .attr('y1',0)\n        .attr('y2',16)\n        .classed(\"active\",function(d,i){\n          return i==0;\n        })\n        .attr('opacity',.5)\n        .attr('id', function (d) {\n          if (d.date.length >4)\n            {return 'date' + d.date.slice(0,4)}\n          else\n            {return 'date' + d.date}\n        });\n\n    //add the selected citation container\n    var citationContainer = container.append('div')\n      .attr('class','citationContainer')\n      .text('(' + citationData[0].date + ') ' + citationData[0]['#text'])\n\n    sliderContainer\n      .append('input')\n        .attr('type','range')\n        .attr('min',firstDate)\n        .attr('max',lastDate)\n        .attr('id','rangeSLider')\n        .attr('value',firstDate)\n        .attr('step',1)\n        .attr('class','slider')\n        .attr('dates',citationDates.map(function(d){\n          return +d;\n        }))\n\n        .on(\"input\",function(d){\n          var value = d3.select(this).property(\"value\")\n\n          var dates = citationDates.map(function(d){\n            return +d;\n          })\n\n          var selected = dates.reduce((prev, curr) => Math.abs(curr - value) < Math.abs(prev - value) ? curr : prev);\n\n          citationCircles.classed(\"active\",function(d){\n            if(+d.date == selected){\n              var text = d[\"#text\"];\n\n              citationContainer\n                .text('(' + selected + ') ' + d[\"#text\"])\n\n              return true;\n            }\n            return false;\n          })\n        })\n\n  }\n  else {\n\n    var citationData = datapoints;\n\n    var citationContainer = container.append('div')\n      .attr('class','citationContainer')\n      .text('(' + citationData.date + ') ' + citationData['#text'])\n\n  }\n\n\n}\n\n//begin scrolly function\nfunction setupScroller() {\n\n      //define the data, run function\n    d3.json('assets/data/ass_long_data.json').then(function(d){\n      setupAssLine(d[186].citations,d3.select(\"#graphic2\"))\n    })\n    .catch(function(error){\n         // handle error\n      })\n      //end of data read/script\n\n    }\n//end of scrolly function\n\n//-----------------//\n\n//adding charts to stack\n\nfunction buildCitationTimeline(usageData,icebergnumber,overlaynumber) {\n\n\n      //set up variables\n      // const margin = { top: 20, right: 20, bottom: 20, left: 20 }\n      // const height = window.innerHeight - margin.top - margin.bottom\n      // const width = window.innerWidth - margin.left - margin.right\n      //\n      // var svg = d3.select(overlaynumber)\n      //   .append('svg')\n      //   .attr('class','time-line')\n      //   .attr('width',width)\n      //   .attr('height',height-margin.bottom)\n      //   .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n      // var lineFunction = d3.line()\n      //   .x(function(d) { return d.x; })\n      //   .y(function(d) { return d.y; })\n      // var lineData = [ { \"x\": width*.1,   \"y\": height*.2},  { \"x\": width*.9,  \"y\": height*.2} ]\n\n\n      //filter data and only do line if more than 1 citation\n      if (usageData.number_of_citations == 1) {\n          var citationData = Array(usageData.citations)\n\n          //add circle for each citation\n        // var citationCircles = svg.selectAll('.citation-circle')\n        //     .data(citationData)\n        //     .enter().append('circle')\n        //     .attr('cx',width/2)\n        //     .attr('class','citation-circle')\n        //     .attr('cy',height*.2)\n        //     .attr('r',4)\n        //     .attr('opacity',1)\n        //     .attr('text', function (d){\n        //       return d['#text']\n        //     })\n        //     .attr('fill','#F24C3D')\n        //     .attr('id', function (d) {\n        //\n        //       if (d.date.length >4)\n        //         {return 'date' + d.date.slice(0,4)}\n        //       else\n        //         {return 'date' + d.date}\n        //     })\n        //\n        //   if (citationData[0].date.length > 4)\n        //     {var yearLabelText = citationData[0].date.slice(0,4)}\n        //   else\n        //     {var yearLabelText = citationData[0].date}\n        //\n\n      //   var yearLabelStart = svg.append('g')\n      //     .attr('transform','translate(' + width*.5 +','+ height*.23 + ')')\n      //     .append('text')\n      //     .text(yearLabelText)\n      //     .attr('class','year-label')\n      //\n      //           //add the selected citation container\n      // var citationContainer = d3.select(overlaynumber).append('div')\n      //   .attr('class','citationContainerIceberg')\n      //   .text('(' + citationData[0].date + ') ' + citationData[0]['#text'])\n\n\n      }\n      else {\n        var citationData = usageData.citations\n        // setupAssLine(citationData)\n\n      //   var x\n      //   var citationCounter = 0\n      //   for (x of citationData){\n      //     if (x['@first'] == 'yes')\n      //       {citationData = citationData.slice(citationCounter,)}\n      //     citationCounter = citationCounter + 1\n      //   }\n      //\n      //   //grab just the dates\n      //   var citationDates = citationData.map(function (d) {return d.date})\n      //   var x\n      //   var indexCounter = 0\n      //     //remove extraneous years\n      //   for (x of citationDates) {\n      //    if (x.length > 4) {\n      //     var newDate = x.slice(0,4)\n      //     citationDates[indexCounter] = newDate\n      //    }\n      //    else {}\n      //    indexCounter = indexCounter + 1\n      //   }\n      //\n      //     //set up scales\n      // var xPositionScale = d3.scaleLinear()\n      //   .domain([d3.min(citationDates),d3.max(citationDates)])\n      //   .range([width*.1,width*.9])\n      //\n      // //add the timeline\n      // var timeLine = svg.append('path')\n      //     //.transition().duration(2000)\n      //     .attr('d',lineFunction(lineData))\n      //     .attr('stroke-width',2)\n      //     .attr('stroke','#333333')\n      //\n      // //add axis labels\n      //\n      // var yearLabelStart = svg.append('g')\n      //   .attr('transform','translate(' + width*.1 +','+ height*.23 + ')')\n      //   .append('text')\n      //     .text(d3.min(citationDates))\n      //     .attr('class','year-label')\n      //\n      // var yearLabelEnd = svg.append('g')\n      //   .attr('transform','translate(' + width*.9 +','+ height*.23 + ')')\n      //   .append('text')\n      //     .text(d3.max(citationDates))\n      //     .attr('class','year-label')\n      //\n      //   //add circle for each citation\n      //   var citationCircles = svg.selectAll('.citation-circle')\n      //       .data(citationData)\n      //       .enter().append('circle')\n      //       .attr('cx',function (d) {\n      //         return xPositionScale(d.date)\n      //       })\n      //       .attr('class','citation-circle')\n      //       .attr('cy',height*.2)\n      //       .attr('r',4)\n      //       .attr('opacity',.5)\n      //       .attr('text', function (d){\n      //         return d['#text']\n      //       })\n      //       .attr('fill','#F24C3D')\n      //       .attr('id', function (d) {\n      //\n      //         if (d.date.length >4)\n      //           {return 'date' + d.date.slice(0,4)}\n      //         else\n      //           {return 'date' + d.date}\n      //       })\n      //\n      // //add a slider\n      // var sliderContainer = d3.select(overlaynumber).append('div')\n      //   .attr('class','slider-container')\n      //\n      //\n      // var slider = sliderContainer.append('input')\n      //   .attr('type','range')\n      //   .attr('min',d3.min(citationDates))\n      //   .attr('max',d3.max(citationDates))\n      //   .attr('id','rangeSlider')\n      //   .attr('value',d3.min(citationDates))\n      //   .attr('step',1)\n      //   .attr('class','sliderIceberg')\n      //   .attr('dates',citationDates)\n      //   // .attr('oninput','selectCitationIceberg(this.value)')\n      //   // .attr('onstart','selectCitationIceberg(this.value)')\n      //\n      // //add the selected citation container\n      // var citationContainer = d3.select(overlaynumber).append('div')\n      //   .attr('class','citationContainerIceberg')\n      //   .text('(' + citationData[0].date + ') ' + citationData[0]['#text'])\n\n\n\n//end of if/else\n      }\n\n//end of function\n}\n\n//---------------------///\n\nfunction buildIcebergTextChart(filename,icebergnumber,overlaynumber) {\n      //time to make some charts\n\n      //define the data, run function\n    d3.json(filename).then(\n    //begin function\n    function icebergChart(datapoints) {\n      var citationsLengths = datapoints.map(function (d) {return d.number_of_citations})\n\n\n      //set up scales\n      var colorScale = d3.scaleOrdinal()\n        .domain(['noun','compound','phrase','adjective','suffix','verb','adverb'])\n        .range(['#FABD21','#DB2CCA','#8633FF','#DB772C','#F24C3D','green','gray'])\n\n\n      var container = d3.select(icebergnumber)\n\n      //append span groups to svg\n      var spans = container.selectAll('span')\n        .data(datapoints)\n        .enter().append('span')\n        .sort(function(x, y){\n          return y.number_of_citations - x.number_of_citations\n        })\n        .attr('class','iceberg-text')\n        .attr('opacity',.8)\n        .style('color', '#333333')\n        .text(function(d) {\n          return d.word + '  '\n        })\n        .on('mouseover', function(d, i) {\n          var currentState = this\n            d3.select(this).style('opacity', 1);\n        })\n        .on('mouseout', function(d, i) {\n          var currentState = this\n            d3.select(this).style('opacity', .8);\n        })\n        .on('click', function (d,i) {\n          var overlay = d3.select(overlaynumber)\n            .classed('active',true)\n            .on('click', d3.select(this).classed('active',false))\n          var usageData = d3.select(this)['_groups'][0][0]['__data__']\n          buildCitationTimeline(usageData,icebergnumber,overlaynumber)\n        })\n\n      var leftShape = d3.select('#left-shape1')\n        .style('height','101em')\n        // .style('height','2000px')\n      var rightShape = d3.select('#right-shape1')\n        .style('height','101em')\n\n    //end of function\n    }).catch(function(error){\n         // handle error\n      })\n      //end of data read/script\n    }\n\nfunction buildIcebergTextList(filename,icebergnumber,overlaynumber) {\n      //time to make some charts\n\n      //define the data, run function\n    d3.json(filename).then(\n    //begin function\n    function icebergChart(datapoints) {\n      var overlayHeight = window.innerHeight\n\n      d3.select(overlaynumber).transition()\n        .style('height',(overlayHeight + 'px'))\n\n      var container = d3.select(icebergnumber)\n\n      //append circle groups to svg\n      var usages = container.append(\"div\").attr(\"class\",\"usage-wrapper\").selectAll('.usage-rows')\n        .data(datapoints)\n        .enter()\n        .append('div')\n        .attr(\"class\",\"usage-rows\")\n\n      usages.append(\"p\")\n        .attr('class','usage-examples')\n        // .style('color', '#333333')\n        .text(function(d,i) {\n          return (i+1) + '. ' + d.ismo_example\n        })\n\n      usages.append(\"p\")\n        .attr('class','word-container')\n        .html(function(d){\n          return \"<span class='first'>\"+d.word + \"</span> <span class='sense-container'><i>\"+ d.part_of_speech + \"</i> ; \" + d.definition + \"</span>\";\n        })\n\n      // var usageData = d3.select(this)['_groups'][0][0]['__data__']\n\n\n      usages.append(\"div\")\n        .attr('class','def-container')\n        .each(function(d){\n          var container = d3.select(this);\n          var data = d.citations\n          setupAssLine(data,container)\n        })\n\n      // var senseContainer = usages.append('p')\n      //   .attr('class','sense-container')\n      //   .text(function(d){\n      //     return\n        // })\n\n\n\n\n        // .on('click', function (d,i) {\n        //\n        //   // var overlay = d3.select(overlaynumber)\n        //   //   .classed('active',true)\n        //   //   .on('click', d3.select(this).classed('active',false))\n        //\n        //\n        //   console.log(usageData,icebergnumber,overlaynumber);\n        //\n        //   buildCitationTimeline(usageData,icebergnumber,overlaynumber)\n        // })\n\n    //end of function\n    }).catch(function(error){\n         // handle error\n      })\n      //end of data read/script\n    }\n\n//run functions\nfunction init() {\n  console.log('Make something awesome!');\n  //Run the stepper\n  setupStepper()\n  //Run the scroller\n  setupScroller()\n  //Build charts\n  buildIcebergTextList('assets/data/ass_ismo_citations_final.json','#iceberg0','#overlay0')\n  buildIcebergTextChart('assets/data/ass_long_data.json','#iceberg1','#overlay1')\n  buildIcebergTextChart('assets/data/fuck_long_data.json','#iceberg2','#overlay2')\n  buildIcebergTextChart('assets/data/dog_long_data.json','#iceberg3','#overlay3')\n  buildIcebergTextChart('assets/data/shit_long_data.json','#iceberg4','#overlay4')\n\n}\n\n\n\nexport default { init, resize };\n","const fallbackData = [\n  {\n    image: '2018_02_stand-up',\n    url: '2018/02/stand-up',\n    hed: 'The Structure of Stand-Up Comedy',\n  },\n  {\n    image: '2018_04_birthday-paradox',\n    url: '2018/04/birthday-paradox',\n    hed: 'The Birthday Paradox Experiment',\n  },\n  {\n    image: '2018_11_boy-bands',\n    url: '2018/11/boy-bands',\n    hed: 'Internet Boy Band Database',\n  },\n  {\n    image: '2018_08_pockets',\n    url: '2018/08/pockets',\n    hed: 'Womens Pockets are Inferior',\n  },\n];\n\nlet storyData = null;\n\nfunction loadJS(src, cb) {\n  const ref = document.getElementsByTagName('script')[0];\n  const script = document.createElement('script');\n  script.src = src;\n  script.async = true;\n  ref.parentNode.insertBefore(script, ref);\n\n  if (cb && typeof cb === 'function') {\n    script.onload = cb;\n  }\n\n  return script;\n}\n\nfunction loadStories(cb) {\n  const request = new XMLHttpRequest();\n  const v = Date.now();\n  const url = `https://pudding.cool/assets/data/stories.json?v=${v}`;\n  request.open('GET', url, true);\n\n  request.onload = () => {\n    if (request.status >= 200 && request.status < 400) {\n      const data = JSON.parse(request.responseText);\n      cb(data);\n    } else cb(fallbackData);\n  };\n\n  request.onerror = () => cb(fallbackData);\n\n  request.send();\n}\n\nfunction createLink(d) {\n  return `\n\t<a class='footer-recirc__article' href='https://pudding.cool/${\n    d.url\n  }' target='_blank'>\n\t\t<img class='article__img' src='https://pudding.cool/common/assets/thumbnails/640/${\n      d.image\n    }.jpg' alt='${d.hed}'>\n\t\t<p class='article__headline'>${d.hed}</p>\n\t</a>\n\t`;\n}\n\nfunction recircHTML() {\n  const url = window.location.href;\n  const html = storyData\n    .filter(d => !url.includes(d.url))\n    .slice(0, 4)\n    .map(createLink)\n    .join('');\n\n  d3.select('.pudding-footer .footer-recirc__articles').html(html);\n}\n\nfunction setupSocialJS() {\n  // facebook\n  (function(d, s, id) {\n    let js;\n\n    const fjs = d.getElementsByTagName(s)[0];\n    if (d.getElementById(id)) return;\n    js = d.createElement(s);\n    js.id = id;\n    js.src = '//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.7';\n    fjs.parentNode.insertBefore(js, fjs);\n  })(document, 'script', 'facebook-jssdk');\n\n  loadJS('https://platform.twitter.com/widgets.js');\n}\n\nfunction init() {\n  loadStories(data => {\n    storyData = data;\n\n    recircHTML();\n    setupSocialJS();\n  });\n}\n\nexport default { init };\n","/* global d3 */\nimport debounce from 'lodash.debounce';\nimport isMobile from './utils/is-mobile';\nimport graphic from './graphic';\nimport footer from './footer';\n\nconst $body = d3.select('body');\nlet previousWidth = 0;\n\nfunction resize() {\n  // only do resize on width changes, not height\n  // (remove the conditional if you want to trigger on height change)\n  const width = $body.node().offsetWidth;\n  if (previousWidth !== width) {\n    previousWidth = width;\n    graphic.resize();\n  }\n}\n\nfunction setupStickyHeader() {\n  const $header = $body.select('header');\n  if ($header.classed('is-sticky')) {\n    const $menu = $body.select('.header__menu');\n    const $toggle = $body.select('.header__toggle');\n    $toggle.on('click', () => {\n      const visible = $menu.classed('is-visible');\n      $menu.classed('is-visible', !visible);\n      $toggle.classed('is-visible', !visible);\n    });\n  }\n}\n\nfunction init() {\n  // add mobile class to body tag\n  $body.classed('is-mobile', isMobile.any());\n  // setup resize event\n\n  //set stepperHeight\n\n  var w = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\n  var h = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n  d3.select(\".stepper\").style(\"height\",h+\"px\");\n\n\n  window.addEventListener('resize', debounce(resize, 150));\n  // setup sticky header menu\n  // setupStickyHeader();\n  // kick off graphic code\n  graphic.init();\n  // load footer stories\n  footer.init();\n}\n\ninit();\n"]}